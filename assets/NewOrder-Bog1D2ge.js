import{d as Ye,j as e,U as Ne,S as te,P as Ge,e as Qe,f as Xe,h as ge,u as He,i as Je,k as Ke,l as Ze,m as es,r,n as ss,o as ts,p as as,q as ns,s as rs,t as p,X as ls,M as _e,v as is,w as os,x as cs,y as ds,z as xs,A as ms,B as Te}from"./index-5BBH6EYD.js";import{C as qe}from"./clock-DQNmFzge.js";import{M as Oe}from"./message-square-WKdJ96rT.js";import{M as ve}from"./minus-mNWsCceW.js";import{B as us}from"./banknote-DaGWq9bt.js";import{S as ps}from"./smartphone-D4_JQhUN.js";import{u as hs}from"./useCurrency-Deld2iQ7.js";import{u as fs}from"./useDemoGuard-DzDEdnwi.js";import{C as bs}from"./chevron-up-DFJQhmpt.js";const js=[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]],gs=Ye("bike",js);function Ie({isMobile:b=!1,orderType:j,setOrderType:F,selectedTable:ae,setSelectedTable:$,onTableSelect:A,tables:U,customerName:ne,setCustomerName:W,customerPhone:re,setCustomerPhone:Y,cart:g,cartItemsCount:G,cartTotal:z,ivaRate:Q,ivaAmount:X,ivaIncluded:x=!0,grandTotal:y,expandedItemId:f,setExpandedItemId:M,notes:m,setNotes:k,paymentMethod:h,setPaymentMethod:N,smacPassed:d,setSmacPassed:v,smacEnabled:P=!0,isSubmitting:H,clearCart:O,updateQuantity:w,removeFromCart:I,updateItemNotes:C,submitOrder:E,isSessionOrder:S=!1,sessionTableName:D}){return e.jsxs("div",{className:`flex flex-col ${b?"h-full":""}`,children:[S&&e.jsx("div",{className:"p-3 bg-primary-500/10 border-b border-primary-500/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-white",children:D}),e.jsx("p",{className:"text-sm text-primary-400",children:"Aggiungi al conto"})]}),e.jsx("div",{className:"px-3 py-1 bg-primary-500/20 rounded-lg",children:e.jsx("span",{className:"text-sm font-medium text-primary-400",children:"Conto Aperto"})})]})}),!S&&e.jsxs("div",{className:"p-3 border-b border-dark-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>F("dine_in"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${j==="dine_in"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(Ne,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Tavolo"})]}),e.jsxs("button",{onClick:()=>F("takeaway"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${j==="takeaway"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(qe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Asporto"})]}),e.jsxs("button",{onClick:()=>F("delivery"),className:`flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl transition-all flex-1 ${j==="delivery"?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(gs,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Domicilio"})]})]}),j==="dine_in"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-dark-400 mb-2",children:"Seleziona tavolo:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.map(a=>e.jsx("button",{onClick:()=>A?A(a.id):$(a.id),className:`px-4 py-2 rounded-xl text-sm font-medium transition-all ${ae===a.id?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:a.name},a.id))})]}),(j==="takeaway"||j==="delivery")&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Nome cliente",value:ne,onChange:a=>W(a.target.value),className:"input py-2.5 text-base"}),e.jsx("input",{type:"tel",placeholder:"Telefono",value:re,onChange:a=>Y(a.target.value),className:"input py-2.5 text-base"})]})]}),e.jsxs("div",{className:"px-3 py-2 bg-dark-900/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-primary-400"}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[G," articoli"]})]}),g.length>0&&e.jsx("button",{onClick:O,className:"text-xs text-red-400 hover:text-red-300 transition-colors px-2 py-1",children:"Svuota"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 min-h-[150px]",children:g.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-dark-400 py-8",children:[e.jsx(te,{className:"w-12 h-12 mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Carrello vuoto"}),e.jsx("p",{className:"text-xs mt-1",children:"Tocca un prodotto per aggiungerlo"})]}):e.jsx("div",{className:"space-y-2",children:g.map(a=>e.jsxs("div",{className:"bg-dark-900 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-white text-sm truncate",children:a.name}),e.jsxs("p",{className:"text-xs text-primary-400 mt-0.5",children:["â‚¬",a.price.toFixed(2)," Ã— ",a.quantity," = â‚¬",(a.price*a.quantity).toFixed(2)]}),a.notes&&f!==a.id&&e.jsxs("p",{className:"text-xs text-amber-400 mt-1 truncate",children:["ðŸ“ ",a.notes]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>M(f===a.id?null:a.id),className:`w-9 h-9 rounded-lg flex items-center justify-center transition-colors ${f===a.id||a.notes?"bg-amber-500/20 text-amber-400":"bg-dark-700 text-dark-400 hover:bg-dark-600"}`,children:e.jsx(Oe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(a.id,-1),className:"w-9 h-9 rounded-lg bg-dark-700 flex items-center justify-center hover:bg-dark-600 transition-colors",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center text-base font-semibold",children:a.quantity}),e.jsx("button",{onClick:()=>w(a.id,1),className:"w-9 h-9 rounded-lg bg-dark-700 flex items-center justify-center hover:bg-dark-600 transition-colors",children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>I(a.id),className:"w-9 h-9 ml-1 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors flex items-center justify-center",children:e.jsx(Qe,{className:"w-4 h-4"})})]})]}),f===a.id&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-xs text-amber-400 font-medium",children:"Note / Variazioni"})]}),e.jsx("input",{type:"text",value:a.notes||"",onChange:u=>C(a.id,u.target.value),placeholder:"Es: senza cipolla, piccante...",className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-sm text-white placeholder-dark-500 focus:outline-none focus:border-amber-500"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:["Senza cipolla","Piccante","Extra salsa","Ben cotto"].map(u=>e.jsxs("button",{onClick:()=>{const _=a.notes||"",le=_?`${_}, ${u}`:u;C(a.id,le)},className:"px-2.5 py-1 text-xs bg-dark-700 text-dark-300 rounded-lg hover:bg-dark-600 transition-colors",children:["+ ",u]},u))})]})]},a.id))})}),g.length>0&&e.jsxs("div",{className:"border-t border-dark-700 bg-dark-800",children:[e.jsx("div",{className:"px-3 py-2 border-b border-dark-700",children:e.jsx("input",{type:"text",placeholder:"Note ordine (opzionale)...",value:m,onChange:a=>k(a.target.value),className:"input py-2.5 text-base"})}),!S&&e.jsxs("div",{className:"px-3 py-3 flex items-center gap-2 border-b border-dark-700",children:[e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs("button",{onClick:()=>N("cash"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${h==="cash"?"bg-emerald-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(us,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Contanti"})]}),e.jsxs("button",{onClick:()=>N("card"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${h==="card"?"bg-blue-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(Xe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Carta"})]}),e.jsxs("button",{onClick:()=>N("online"),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-xl transition-all flex-1 ${h==="online"?"bg-purple-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[e.jsx(ps,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Online"})]})]}),P&&e.jsxs("button",{onClick:()=>v(!d),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl transition-all ${d?"bg-primary-500 text-dark-900":"bg-dark-700 text-dark-300 hover:bg-dark-600"}`,children:[d&&e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"SMAC"})]})]}),e.jsx("div",{className:"px-3 py-3 space-y-1",children:S?e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white",children:[e.jsx("span",{children:"Totale Comanda"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",z.toFixed(2)]})]}):x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white",children:[e.jsx("span",{children:"Totale"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-dark-500",children:[e.jsxs("span",{children:["di cui IVA (",Q,"%)"]}),e.jsxs("span",{children:["â‚¬",X.toFixed(2)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm text-dark-400",children:[e.jsx("span",{children:"Subtotale"}),e.jsxs("span",{children:["â‚¬",z.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-dark-400",children:[e.jsxs("span",{children:["+ IVA (",Q,"%)"]}),e.jsxs("span",{children:["â‚¬",X.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold text-white pt-2",children:[e.jsx("span",{children:"Totale"}),e.jsxs("span",{className:"text-primary-400",children:["â‚¬",y.toFixed(2)]})]})]})}),e.jsx("div",{className:"p-3 pt-0 pb-safe",children:e.jsx("button",{onClick:E,disabled:g.length===0||H,className:"btn-primary w-full py-4 text-base font-semibold",children:H?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-dark-900"}):S?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),"Invia Comanda - â‚¬",z.toFixed(2)]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),"Conferma Ordine - â‚¬",y.toFixed(2)]})})})]}),g.length===0&&e.jsx("div",{className:"p-3 border-t border-dark-700 pb-safe",children:e.jsxs("button",{disabled:!0,className:"btn-primary w-full py-4 opacity-50 cursor-not-allowed text-base",children:[e.jsx(te,{className:"w-5 h-5"}),"Aggiungi prodotti"]})})]})}function Os(){He();const{formatPrice:b}=hs(),{smacEnabled:j}=Je(),{checkCanWrite:F}=fs(),{user:ae}=Ke(),$=Ze(),[A]=es(),[U,ne]=r.useState([]),[W,re]=r.useState([]),[Y,g]=r.useState([]),[G,z]=r.useState(null),[Q,X]=r.useState(!0),[x,y]=r.useState(null),[f,M]=r.useState(null),[m,k]=r.useState([]),[h,N]=r.useState("dine_in"),[d,v]=r.useState(null),[P,H]=r.useState("cash"),[O,w]=r.useState(""),[I,C]=r.useState(""),[E,S]=r.useState(""),[D,a]=r.useState(!1),[u,_]=r.useState(!1),[le,ye]=r.useState(null),[Fe,ie]=r.useState(!1),[$e,J]=r.useState(!1),[i,oe]=r.useState(null),[ce,de]=r.useState([]),[K,xe]=r.useState(null),[Ae,Z]=r.useState(!1),[V,me]=r.useState(null),[o,ee]=r.useState({covers:"2",customer_name:"",customer_phone:""}),ue=A.get("session"),pe=A.get("table");r.useEffect(()=>{ze()},[ue,pe]);async function ze(){try{const[s,t,l,n]=await Promise.all([ss(),ts(),as(),ns()]);if(ne(s),re(t),g(l),z(n),s.length>0&&M(s[0].id),ue){const L=parseInt(ue),c=await rs(L);c&&(y(c),v(c.table_id),N("dine_in"),c.customer_name&&w(c.customer_name),c.customer_phone&&C(c.customer_phone))}else pe&&(v(parseInt(pe)),N("dine_in"))}catch(s){console.error("Error loading data:",s),p("Errore nel caricamento dati","error")}finally{X(!1)}}const ke=f?W.filter(s=>s.category_id===f&&s.available):W.filter(s=>s.available),T=m.reduce((s,t)=>s+t.price*t.quantity,0),B=m.reduce((s,t)=>s+t.quantity,0),he=G?.iva_rate||17,fe=G?.iva_included!==!1,we=fe?T-T/(1+he/100):T*(he/100),R=fe?T:T+we;function Ce(s){k(t=>t.find(n=>n.id===s.id)?t.map(n=>n.id===s.id?{...n,quantity:n.quantity+1}:n):[...t,{...s,quantity:1}]),p(`${s.name} aggiunto`,"success")}function be(s,t){k(l=>l.map(n=>n.id===s?{...n,quantity:Math.max(0,n.quantity+t)}:n).filter(n=>n.quantity>0))}function Me(s){k(t=>t.filter(l=>l.id!==s))}function Pe(s,t){k(l=>l.map(n=>n.id===s?{...n,notes:t}:n))}function Ee(){k([]),ye(null)}async function De(s){if(x)return;const t=await os(s);if(t){const l=await cs(t.id);oe(t),de(l),xe(s),J(!0)}else v(s),y(null)}async function Ve(){!i||!K||(y(i),v(K),N("dine_in"),i.customer_name&&w(i.customer_name),i.customer_phone&&C(i.customer_phone),J(!1),oe(null),de([]),xe(null),p("Comanda associata al conto aperto","success"))}function Be(){K&&v(K),J(!1),oe(null),de([]),xe(null)}async function Re(){if(F()){if(m.length===0){p("Aggiungi almeno un prodotto","warning");return}if(h==="dine_in"&&!d&&!x){p("Seleziona un tavolo","warning");return}if(h==="dine_in"&&d&&!x){const s={date:new Date().toISOString().split("T")[0],total:R,payment_method:P,order_type:h,table_id:d,notes:E||void 0,status:"pending",smac_passed:D,customer_name:O||void 0,customer_phone:I||void 0},t=m.map(n=>({menu_item_id:n.id,quantity:n.quantity,price:n.price,notes:n.notes})),l=Y.find(n=>n.id===d)?.name||`Tavolo ${d}`;ee({covers:"2",customer_name:O||"",customer_phone:I||""}),me({order:s,items:t,tableId:d,tableName:l}),Z(!0);return}await je()}}async function je(s,t){_(!0);try{const l=m.map(q=>({menu_item_id:q.id,quantity:q.quantity,price:q.price,notes:q.notes})),n=x||s,L=x?.id||t;let c;L&&(c=await xs(L));const We={date:new Date().toISOString().split("T")[0],total:n?T:R,payment_method:n?"cash":P,order_type:h,table_id:h==="dine_in"?d??void 0:void 0,notes:E||void 0,status:"pending",smac_passed:n?!1:D,customer_name:O||void 0,customer_phone:I||void 0,session_id:L,order_number:c,created_by:ae?.name};if(await ms(We,l),x){await Te(x.id);const q=c&&c>1?`Comanda ${c} inviata!`:"Prima comanda inviata!";p(q,"success"),$("/tables")}else t?(await Te(t),p("Ordine creato e conto aperto!","success"),$("/tables")):(p("Ordine creato con successo!","success"),$("/orders"))}catch(l){console.error("Error creating order:",l),p("Errore nella creazione dell'ordine","error")}finally{_(!1)}}async function Le(){if(!V)return;const s=parseInt(o.covers)||1;if(s<1){p("Inserisci almeno 1 coperto","warning");return}_(!0);try{const t=await ds(V.tableId,s,o.customer_name||void 0,o.customer_phone||void 0);o.customer_name&&w(o.customer_name),o.customer_phone&&C(o.customer_phone),Z(!1),me(null),await je(!0,t.id)}catch(t){console.error("Error creating session:",t),p("Errore nell'apertura del conto","error"),_(!1)}}async function Ue(){V&&(Z(!1),me(null),await je(!1))}if(Q)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})});const se=!!x,Se={orderType:h,setOrderType:se?()=>{}:N,selectedTable:d,setSelectedTable:se?()=>{}:v,onTableSelect:se?void 0:De,tables:Y,customerName:O,setCustomerName:w,customerPhone:I,setCustomerPhone:C,cart:m,cartItemsCount:B,cartTotal:T,ivaRate:he,ivaAmount:we,ivaIncluded:fe,grandTotal:R,expandedItemId:le,setExpandedItemId:ye,notes:E,setNotes:S,paymentMethod:P,setPaymentMethod:H,smacPassed:D,setSmacPassed:a,smacEnabled:j,isSubmitting:u,clearCart:Ee,updateQuantity:be,removeFromCart:Me,updateItemNotes:Pe,submitOrder:Re,isSessionOrder:se,sessionTableName:x?.table_name};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden lg:flex gap-4 h-[calc(100vh-100px)]",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:U.map(s=>e.jsx("button",{onClick:()=>M(s.id),className:`px-6 py-3 rounded-xl font-medium whitespace-nowrap transition-all ${f===s.id?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300 hover:bg-dark-700"}`,children:s.name},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto pt-1",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4 pt-2",children:ke.map(s=>{const t=m.find(l=>l.id===s.id);return e.jsxs("button",{onClick:()=>Ce(s),className:"menu-item-card text-left relative overflow-visible",children:[t&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 w-7 h-7 bg-primary-500 rounded-full flex items-center justify-center text-sm font-bold text-dark-900 z-20 shadow-lg",children:t.quantity}),e.jsx("h3",{className:"font-semibold text-white mb-1 line-clamp-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-dark-400 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("p",{className:"text-xl font-bold text-primary-400",children:b(s.price)}),t&&e.jsx("div",{onClick:l=>{l.stopPropagation(),be(s.id,-1)},className:"w-8 h-8 rounded-lg bg-dark-700 hover:bg-red-500/20 flex items-center justify-center transition-colors cursor-pointer",children:e.jsx(ve,{className:"w-4 h-4 text-red-400"})})]})]},s.id)})})})]}),e.jsx("div",{className:"w-[420px] flex flex-col bg-dark-800 rounded-2xl border border-dark-700",children:e.jsx(Ie,{...Se})})]}),e.jsxs("div",{className:"lg:hidden flex flex-col h-[calc(100vh-120px)]",children:[e.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto pb-2 -mx-3 px-3",children:U.map(s=>e.jsx("button",{onClick:()=>M(s.id),className:`px-4 py-2.5 rounded-xl font-medium whitespace-nowrap transition-all text-sm ${f===s.id?"bg-primary-500 text-dark-900":"bg-dark-800 text-dark-300"}`,children:s.name},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto -mx-3 px-3 pb-24 pt-3",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 pt-1",children:ke.map(s=>{const t=m.find(l=>l.id===s.id);return e.jsxs("button",{onClick:()=>Ce(s),className:"relative bg-dark-800 rounded-xl p-3 text-left border border-dark-700 active:scale-[0.98] transition-transform overflow-visible",children:[t&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center text-xs font-bold text-dark-900 z-20 shadow-lg",children:t.quantity}),e.jsx("h3",{className:"font-semibold text-white text-sm line-clamp-2 mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-lg font-bold text-primary-400",children:b(s.price)}),t&&e.jsx("div",{onClick:l=>{l.stopPropagation(),be(s.id,-1)},className:"w-7 h-7 rounded-lg bg-dark-700 active:bg-red-500/30 flex items-center justify-center transition-colors",children:e.jsx(ve,{className:"w-3.5 h-3.5 text-red-400"})})]})]},s.id)})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-dark-900 border-t border-dark-700 lg:hidden z-30 safe-bottom",children:e.jsxs("button",{onClick:()=>ie(!0),className:"w-full flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"w-6 h-6 text-primary-400"}),B>0&&e.jsx("span",{className:"absolute -top-2 -right-2 w-5 h-5 bg-primary-500 rounded-full flex items-center justify-center text-xs font-bold text-dark-900",children:B})]}),e.jsx("span",{className:"text-white font-medium",children:m.length===0?"Carrello vuoto":`${B} articoli`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-primary-400",children:b(R)}),e.jsx(bs,{className:"w-5 h-5 text-dark-400"})]})]})}),Fe&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>ie(!1)}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-dark-800 rounded-t-3xl max-h-[90vh] flex flex-col animate-slide-up",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-1",children:e.jsx("div",{className:"w-12 h-1.5 bg-dark-600 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-dark-700",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Il tuo ordine"}),e.jsx("button",{onClick:()=>ie(!1),className:"p-2 hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx(ls,{className:"w-6 h-6 text-dark-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Ie,{...Se,isMobile:!0})})]})]})]}),e.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
          }
          to {
            transform: translateY(0);
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
        .safe-bottom {
          padding-bottom: env(safe-area-inset-bottom, 0);
        }
        .pb-safe {
          padding-bottom: env(safe-area-inset-bottom, 12px);
        }
      `}),e.jsx(_e,{isOpen:$e,onClose:()=>J(!1),title:"Conto Aperto Rilevato",size:"md",children:i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-500/10 border border-amber-500/30 rounded-xl",children:[e.jsx(is,{className:"w-6 h-6 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-400",children:"Questo tavolo ha giÃ  un conto aperto"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Vuoi aggiungere la comanda al conto esistente?"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-900 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:i.table_name||`Tavolo ${i.table_id}`}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-dark-400",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Coperti"})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:i.covers})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-dark-400",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Comande"})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:ce.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-dark-400",children:"Totale"}),e.jsx("p",{className:"text-lg font-bold text-primary-400",children:b(i.total)})]})]}),i.customer_name&&e.jsxs("p",{className:"mt-3 text-sm text-dark-400",children:["Cliente: ",e.jsx("span",{className:"text-white",children:i.customer_name})]}),ce.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700",children:[e.jsx("p",{className:"text-sm text-dark-400 mb-2",children:"Comande esistenti:"}),e.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:ce.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-dark-300",children:["Comanda #",s.order_number||1]}),e.jsx("span",{className:"text-white",children:b(s.total)})]},s.id))})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:Ve,className:"btn-primary w-full py-3",children:"SÃ¬, aggiungi al conto"}),e.jsx("button",{onClick:Be,className:"btn-secondary w-full",children:"No, crea ordine separato"})]})]})}),e.jsx(_e,{isOpen:Ae,onClose:()=>Z(!1),title:"Aprire un Conto?",size:"md",children:V&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-primary-500/10 border border-primary-500/30 rounded-xl",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-primary-400",children:["Stai creando un ordine per ",V.tableName]}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Vuoi aprire un conto per questo tavolo? CosÃ¬ potrai aggiungere altre comande in seguito."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Numero Coperti *"}),e.jsx("input",{type:"number",min:"1",value:o.covers,onChange:s=>ee({...o,covers:s.target.value}),className:"input w-full",placeholder:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Nome Cliente (opzionale)"}),e.jsx("input",{type:"text",value:o.customer_name,onChange:s=>ee({...o,customer_name:s.target.value}),className:"input w-full",placeholder:"Es. Mario Rossi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-1",children:"Telefono (opzionale)"}),e.jsx("input",{type:"tel",value:o.customer_phone,onChange:s=>ee({...o,customer_phone:s.target.value}),className:"input w-full",placeholder:"Es. 333 1234567"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-900 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-white mb-2",children:"Riepilogo Ordine"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-dark-400",children:[B," articoli"]}),e.jsx("span",{className:"text-xl font-bold text-primary-400",children:b(R)})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:Le,disabled:u,className:"btn-primary w-full py-3",children:u?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-dark-900 mx-auto"}):"Apri Conto e Invia Ordine"}),e.jsx("button",{onClick:Ue,disabled:u,className:"btn-secondary w-full",children:"No, solo ordine singolo (senza conto)"})]})]})})]})}export{Os as NewOrder};
