import{u as ie,i as re,r as d,bc as le,bm as de,D as ce,a3 as oe,s as me,t as j,j as e,H as xe,bj as I,c as $,O as he,f as pe,bn as ue,N as E,U as je,M as R,bo as fe,q as Ne,bp as be}from"./index-DTQOtD2j.js";import{u as ge}from"./useRealtimeRefresh-WJzO9s61.js";import{C as ve}from"./calendar-D8XHi2a0.js";import{B as we}from"./banknote-Bfr6kugK.js";import{S as ye}from"./smartphone-qT9kuGGX.js";import{F as _e}from"./file-text-Z9iPRLmd.js";import{C as Ce}from"./chevron-down-WPXV6KUR.js";import{C as ke}from"./chevron-right-3MLw7nJr.js";import{T as Se}from"./trending-up-CVnQlFJF.js";import{T as Ee}from"./trending-down-Xq6qqqlM.js";import{P as Re}from"./printer-g1QjRDnT.js";function Le(){ie();const{smacEnabled:b}=re(),[p,L]=d.useState(new Date().toISOString().split("T")[0]),[q,F]=d.useState(!0),[a,V]=d.useState(null),[y,H]=d.useState([]),[g,G]=d.useState([]),[B,v]=d.useState(!1),[W,T]=d.useState(!1),[X,_]=d.useState(!1),[l,D]=d.useState(null),[u,z]=d.useState(""),[f,M]=d.useState(""),[A,O]=d.useState(""),C=d.useRef(null),[J,K]=d.useState({}),[P,Q]=d.useState({}),[Y,Z]=d.useState(new Set);d.useEffect(()=>{k()},[p]);async function k(){F(!0);try{const[s,t,n]=await Promise.all([le(p),de(),ce(p)]);V(s),H(t);const m=n.filter(c=>c.status!=="cancelled");G(m);const i=[...new Set(m.filter(c=>c.session_id&&c.session_status==="paid").map(c=>c.session_id))],r={},w={};await Promise.all(i.map(async c=>{const[x,N]=await Promise.all([oe(c),me(c)]);x.length>0&&(r[c]=x),N&&(w[c]=N)})),K(r),Q(w)}catch(s){console.error("Error loading data:",s),j("Errore nel caricamento dati","error")}finally{F(!1)}}ge(k,["orders-updated","table-sessions-updated","reservations-updated","settings-updated"]);const U=y.some(s=>s.date===p);async function ee(){if(!u||!f){j("Inserisci fondo cassa iniziale e finale","error");return}const s=parseFloat(u),t=parseFloat(f);if(isNaN(s)||isNaN(t)||s<0||t<0){j("Inserisci valori numerici validi","error");return}const n=s+(a?.cash_revenue||0),m=t-n;try{await be({date:p,opening_cash:s,closing_cash:t,expected_cash:n,difference:m,total_orders:a?.total_orders||0,total_revenue:a?.total_revenue||0,cash_revenue:a?.cash_revenue||0,card_revenue:a?.card_revenue||0,online_revenue:a?.online_revenue||0,smac_total:a?.smac_total||0,non_smac_total:a?.non_smac_total||0,notes:A,closed_by:"Admin"}),j("Chiusura cassa salvata con successo","success"),v(!1),z(""),M(""),O(""),k()}catch(i){console.error("Error saving closure:",i),j("Errore nel salvataggio","error")}}async function se(s){try{const t=await fe(s);t&&(D(t),_(!0))}catch(t){console.error("Error generating receipt:",t),j("Errore nella generazione scontrino","error")}}async function te(s,t){try{const n=await Ne(),m=new Date(s.paid_at),i={id:s.id,order_id:t.id,receipt_number:`PAG-${s.id}`,date:m.toLocaleDateString("it-IT"),time:m.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),items:s.paid_items?.map(r=>({name:r.menu_item_name,quantity:r.quantity,unit_price:r.price,total:r.quantity*r.price}))||[{name:s.notes||"Pagamento parziale",quantity:1,unit_price:s.amount,total:s.amount}],subtotal:s.amount/(1+n.iva_rate/100),iva_rate:n.iva_rate,iva_amount:s.amount-s.amount/(1+n.iva_rate/100),total:s.amount,payment_method:s.payment_method,smac_passed:s.smac_passed||!1,shop_info:{name:n.shop_name,address:n.address,phone:n.phone}};D(i),_(!0)}catch(n){console.error("Error generating payment receipt:",n),j("Errore nella generazione scontrino","error")}}function ae(){if(C.current){const s=C.current.innerHTML,t=window.open("","_blank");t&&(t.document.write(`
          <html>
            <head>
              <title>Scontrino</title>
              <style>
                body { font-family: 'Courier New', monospace; padding: 20px; max-width: 300px; margin: 0 auto; }
                .header { text-align: center; margin-bottom: 20px; }
                .shop-name { font-size: 18px; font-weight: bold; }
                .divider { border-top: 1px dashed #000; margin: 10px 0; }
                .item { display: flex; justify-content: space-between; margin: 5px 0; }
                .total { font-weight: bold; font-size: 16px; }
                .footer { text-align: center; margin-top: 20px; font-size: 12px; }
              </style>
            </head>
            <body>${s}</body>
          </html>
        `),t.document.close(),t.print())}}const ne=s=>new Date(s).toLocaleDateString("it-IT",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return q?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Chiusura Cassa"}),e.jsx("p",{className:"text-dark-400 mt-1 text-sm sm:text-base",children:"Riepilogo giornaliero e scontrini"})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:()=>T(!0),className:"btn-secondary text-sm sm:text-base px-3 py-2 sm:px-4 sm:py-2.5",children:[e.jsx(xe,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Storico"]}),!U&&a&&a.total_orders>0&&e.jsxs("button",{onClick:()=>v(!0),className:"btn-primary text-sm sm:text-base px-3 py-2 sm:px-4 sm:py-2.5",children:[e.jsx(I,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Chiudi Cassa"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[e.jsx(ve,{className:"w-5 h-5 text-dark-400 hidden sm:block"}),e.jsx("input",{type:"date",value:p,onChange:s=>L(s.target.value),className:"input w-auto text-sm sm:text-base"}),e.jsx("span",{className:"text-dark-400 text-sm sm:text-base hidden sm:inline",children:ne(p)}),U&&e.jsxs("span",{className:"px-2 py-1 sm:px-3 bg-emerald-500/20 text-emerald-400 rounded-full text-xs sm:text-sm flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Cassa Chiusa"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx("div",{className:"stat-card glow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"stat-label text-xs sm:text-sm",children:"Incasso Totale"}),e.jsxs("p",{className:"stat-value text-primary-400 text-lg sm:text-2xl",children:["€",a?.total_revenue.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-dark-500 mt-1",children:[a?.total_orders," ordini"]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-primary-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(he,{className:"w-5 h-5 sm:w-6 sm:h-6 text-primary-400"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"stat-label text-xs sm:text-sm",children:"Contanti"}),e.jsxs("p",{className:"stat-value text-emerald-400 text-lg sm:text-2xl",children:["€",a?.cash_revenue.toFixed(2)]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(we,{className:"w-5 h-5 sm:w-6 sm:h-6 text-emerald-400"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"stat-label text-xs sm:text-sm",children:"Carta"}),e.jsxs("p",{className:"stat-value text-blue-400 text-lg sm:text-2xl",children:["€",a?.card_revenue.toFixed(2)]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-blue-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(pe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-400"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"stat-label text-xs sm:text-sm",children:"Online"}),e.jsxs("p",{className:"stat-value text-purple-400 text-lg sm:text-2xl",children:["€",a?.online_revenue.toFixed(2)]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-purple-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(ye,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-400"})})]})})]}),b&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"card p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx($,{className:"w-4 h-4 sm:w-5 sm:h-5 text-emerald-400"}),e.jsx("h3",{className:"font-semibold text-white text-sm sm:text-base",children:"SMAC Passata"})]}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-emerald-400",children:["€",a?.smac_total.toFixed(2)]})]}),e.jsxs("div",{className:"card p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx(ue,{className:"w-4 h-4 sm:w-5 sm:h-5 text-amber-400"}),e.jsx("h3",{className:"font-semibold text-white text-sm sm:text-base",children:"SMAC Non Passata"})]}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-amber-400",children:["€",a?.non_smac_total.toFixed(2)]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"font-semibold text-white text-sm sm:text-base",children:"Ordini per Tipologia"})}),e.jsxs("div",{className:"p-3 sm:p-4 grid grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-dark-800 rounded-xl",children:[e.jsx("p",{className:"text-xl sm:text-3xl font-bold text-white",children:a?.orders_by_type.dine_in||0}),e.jsx("p",{className:"text-dark-400 text-xs sm:text-sm",children:"In Sala"})]}),e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-dark-800 rounded-xl",children:[e.jsx("p",{className:"text-xl sm:text-3xl font-bold text-white",children:a?.orders_by_type.takeaway||0}),e.jsx("p",{className:"text-dark-400 text-xs sm:text-sm",children:"Asporto"})]}),e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-dark-800 rounded-xl",children:[e.jsx("p",{className:"text-xl sm:text-3xl font-bold text-white",children:a?.orders_by_type.delivery||0}),e.jsx("p",{className:"text-dark-400 text-xs sm:text-sm",children:"Domicilio"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"font-semibold text-white flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(E,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Ordini del Giorno (",g.length," ",g.length===1?"comanda":"comande",")"]})}),e.jsx("div",{className:"divide-y divide-dark-700 max-h-[500px] sm:max-h-[600px] overflow-y-auto",children:g.length===0?e.jsxs("div",{className:"p-6 sm:p-8 text-center text-dark-400",children:[e.jsx(_e,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm sm:text-base",children:"Nessun ordine per questa data"})]}):(()=>{const s={};return g.forEach(t=>{const n=t.session_id?`session_${t.session_id}`:`order_${t.id}`;s[n]||(s[n]=[]),s[n].push(t)}),Object.entries(s).map(([t,n])=>{const m=t.startsWith("session_"),i=n[0],r=i.session_id,w=m&&r&&P[r]?P[r].total:n.reduce((o,h)=>o+h.total,0),c=n.length,x=r?J[r]||[]:[],N=x.length>1,S=r?Y.has(r):!1;return e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center justify-between p-3 sm:p-4 hover:bg-dark-900/50 transition-colors gap-2 ${S?"bg-dark-900/30":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 min-w-0 flex-1",children:[m&&x.length>0?e.jsx("button",{onClick:()=>{r&&Z(o=>{const h=new Set(o);return h.has(r)?h.delete(r):h.add(r),h})},className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-dark-700 flex items-center justify-center flex-shrink-0 hover:bg-dark-600 transition-colors",children:S?e.jsx(Ce,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary-400"}):e.jsx(ke,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary-400"})}):e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-dark-700 flex items-center justify-center flex-shrink-0",children:m?e.jsx("span",{className:"text-xs font-bold text-primary-400",children:c>1?`${c}C`:`#${i.id}`}):e.jsxs("span",{className:"text-xs sm:text-sm font-bold text-primary-400",children:["#",i.id]})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"font-medium text-white text-sm sm:text-base truncate",children:[i.order_type==="dine_in"?"Tavolo":i.order_type==="takeaway"?"Asporto":"Domicilio",i.table_name&&` - ${i.table_name}`,i.customer_name&&e.jsxs("span",{className:"ml-2 text-dark-300",children:["(",i.customer_name,")"]}),N&&e.jsxs("span",{className:"ml-2 text-xs px-2 py-0.5 bg-amber-500/20 text-amber-400 rounded-full inline-flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"Diviso"]})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-dark-400 truncate",children:[N?e.jsxs("span",{children:[x.length," pagamenti"]}):e.jsxs(e.Fragment,{children:[i.payment_method==="cash"?"Contanti":i.payment_method==="card"?"Carta":"Online",b&&i.smac_passed&&" • SMAC"]}),m&&c>1&&e.jsxs("span",{className:"ml-2 text-primary-400",children:["• ",c," comande (#",n.map(o=>o.id).join(", #"),")"]}),m&&e.jsxs("span",{className:`ml-2 ${i.session_status==="open"?"text-amber-400":"text-emerald-400"}`,children:["• ",i.session_status==="open"?"Aperto":"Chiuso"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-shrink-0",children:[e.jsxs("p",{className:"text-sm sm:text-lg font-bold text-primary-400 whitespace-nowrap",children:["€",w.toFixed(2)]}),e.jsx("button",{onClick:()=>se(i.id),className:"p-1.5 sm:p-2 bg-dark-700 rounded-lg hover:bg-dark-600 transition-colors",title:N?"Visualizza scontrino totale riepilogativo":"Visualizza scontrino",children:e.jsx(E,{className:"w-4 h-4 sm:w-5 sm:h-5 text-dark-300"})})]})]}),S&&x.length>0&&e.jsx("div",{className:"bg-dark-900/50 border-t border-dark-700",children:x.map((o,h)=>e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-2 sm:py-3 pl-12 sm:pl-16 border-b border-dark-800 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-dark-500",children:"└"}),e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded bg-dark-700 flex items-center justify-center text-xs font-mono text-dark-400",children:h+1}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-white font-medium",children:["€",o.amount.toFixed(2),o.notes&&e.jsxs("span",{className:"text-dark-400 ml-2 font-normal",children:["(",o.notes,")"]})]}),e.jsxs("p",{className:"text-xs text-dark-500",children:[o.payment_method==="cash"?"Contanti":o.payment_method==="card"?"Carta":"Online"," • ",new Date(o.paid_at).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),b&&e.jsxs("span",{className:o.smac_passed?"text-emerald-400":"text-red-400",children:[" • ","SMAC ",o.smac_passed?"✓":"✗"]})]})]})]}),e.jsx("button",{onClick:()=>te(o,i),className:"p-1.5 sm:p-2 bg-dark-700 rounded-lg hover:bg-dark-600 transition-colors",title:"Visualizza scontrino pagamento",children:e.jsx(E,{className:"w-4 h-4 text-dark-300"})})]},o.id))})]},t)})})()})]}),e.jsx(R,{isOpen:B,onClose:()=>v(!1),title:"Chiusura Cassa",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-dark-400",children:"Incasso Totale:"}),e.jsxs("span",{className:"font-bold text-white",children:[a?.total_revenue.toFixed(2)," EUR"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-dark-400",children:"Di cui Contanti:"}),e.jsxs("span",{className:"font-bold text-emerald-400",children:[a?.cash_revenue.toFixed(2)," EUR"]})]})]}),e.jsxs("div",{className:"md:grid md:grid-cols-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Fondo Cassa Iniziale (EUR)"}),e.jsx("input",{type:"number",step:"0.01",value:u,onChange:s=>z(s.target.value),className:"input",placeholder:"Es: 100.00"})]}),e.jsxs("div",{className:"mt-4 md:mt-0",children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Contanti in Cassa Finale (EUR)"}),e.jsx("input",{type:"number",step:"0.01",value:f,onChange:s=>M(s.target.value),className:"input",placeholder:"Es: 350.00"})]})]}),u&&f&&e.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-dark-400",children:"Contanti Attesi:"}),e.jsxs("span",{className:"font-bold text-white",children:[(parseFloat(u)+(a?.cash_revenue||0)).toFixed(2)," EUR"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-dark-400",children:"Differenza:"}),e.jsxs("span",{className:`font-bold ${parseFloat(f)-(parseFloat(u)+(a?.cash_revenue||0))>=0?"text-emerald-400":"text-red-400"}`,children:[(parseFloat(f)-(parseFloat(u)+(a?.cash_revenue||0))).toFixed(2)," EUR"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:"Note (opzionale)"}),e.jsx("textarea",{value:A,onChange:s=>O(s.target.value),className:"input resize-none h-16",placeholder:"Eventuali note sulla chiusura..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"btn-secondary flex-1",children:"Annulla"}),e.jsxs("button",{onClick:ee,className:"btn-primary flex-1",children:[e.jsx(I,{className:"w-5 h-5"}),"Conferma Chiusura"]})]})]})}),e.jsx(R,{isOpen:W,onClose:()=>T(!1),title:"Storico Chiusure Cassa",size:"lg",children:e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:y.length===0?e.jsx("p",{className:"text-center text-dark-400 py-8",children:"Nessuna chiusura registrata"}):y.slice(0,30).map(s=>e.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"font-semibold text-white",children:new Date(s.date).toLocaleDateString("it-IT",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),e.jsxs("span",{className:`flex items-center gap-1 text-sm ${s.difference>=0?"text-emerald-400":"text-red-400"}`,children:[s.difference>=0?e.jsx(Se,{className:"w-4 h-4"}):e.jsx(Ee,{className:"w-4 h-4"}),s.difference>=0?"+":"",s.difference.toFixed(2)," EUR"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-dark-400",children:"Incasso:"}),e.jsxs("span",{className:"text-white ml-2",children:[s.total_revenue.toFixed(2)," EUR"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-dark-400",children:"Ordini:"}),e.jsx("span",{className:"text-white ml-2",children:s.total_orders})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-dark-400",children:"Contanti:"}),e.jsxs("span",{className:"text-emerald-400 ml-2",children:[s.cash_revenue.toFixed(2)," EUR"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-dark-400",children:"Carta:"}),e.jsxs("span",{className:"text-blue-400 ml-2",children:[s.card_revenue.toFixed(2)," EUR"]})]})]}),s.notes&&e.jsxs("p",{className:"text-dark-500 text-sm mt-2 italic",children:['"',s.notes,'"']})]},s.id))})}),e.jsx(R,{isOpen:X,onClose:()=>_(!1),title:"Scontrino",children:l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{ref:C,className:"bg-white text-black p-6 rounded-lg font-mono text-sm",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"font-bold text-lg",children:l.shop_info.name}),l.shop_info.address&&e.jsx("p",{className:"text-xs",children:l.shop_info.address}),l.shop_info.phone&&e.jsxs("p",{className:"text-xs",children:["Tel: ",l.shop_info.phone]})]}),e.jsx("div",{className:"border-t border-dashed border-gray-400 my-3"}),e.jsxs("div",{className:"text-xs mb-3",children:[e.jsxs("p",{children:["Scontrino: ",l.receipt_number]}),e.jsxs("p",{children:["Data: ",l.date," ",l.time]})]}),e.jsx("div",{className:"border-t border-dashed border-gray-400 my-3"}),e.jsx("div",{className:"space-y-1",children:l.items.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s.quantity,"x ",s.name]}),e.jsx("span",{children:s.total.toFixed(2)})]},t))}),e.jsx("div",{className:"border-t border-dashed border-gray-400 my-3"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Imponibile:"}),e.jsxs("span",{children:[l.subtotal.toFixed(2)," EUR"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["IVA (",l.iva_rate,"%):"]}),e.jsxs("span",{children:[l.iva_amount.toFixed(2)," EUR"]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-base",children:[e.jsx("span",{children:"TOTALE:"}),e.jsxs("span",{children:[l.total.toFixed(2)," EUR"]})]})]}),e.jsx("div",{className:"border-t border-dashed border-gray-400 my-3"}),e.jsxs("div",{className:"text-xs text-center",children:[e.jsxs("p",{children:["Pagamento: ",l.payment_method==="cash"?"Contanti":l.payment_method==="card"?"Carta":"Online"]}),b&&l.smac_passed&&e.jsx("p",{className:"font-bold",children:"SMAC REGISTRATA"})]}),e.jsx("div",{className:"border-t border-dashed border-gray-400 my-3"}),e.jsx("p",{className:"text-center text-xs",children:"Grazie e arrivederci!"})]}),e.jsxs("button",{onClick:ae,className:"btn-primary w-full",children:[e.jsx(Re,{className:"w-5 h-5"}),"Stampa Scontrino"]})]})})]})}export{Le as CashRegister};
